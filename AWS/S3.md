# 新的 2026
## 第一階段：S3 初期設定（建立 + 測試）
- S3 Bucket 建立
  - 名稱: <YOUR_BUCKET_NAME>
  - 區域: <YOUR_AWS_REGION> (e.g., ap-northeast-1)
- Object Ownership
  - 設定為: ACLs disabled (recommended)
- Block Public Access 設定
  - 暫時 Off (Disabled) （為了測試 Public Read）
- Static Website Hosting: 啟用
  - Index document: index.html
- 上傳初始檔案
  - 上傳 index.html（確保檔案在根目錄）
- 設定測試用 Bucket Policy
  - ```JSON
    {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "AllowPublicReadForTesting",
          "Effect": "Allow",
          "Principal": "*",
          "Action": "s3:GetObject",
          "Resource": "arn:aws:s3:::<YOUR_BUCKET_NAME>/*"
        }
      ]
    }
    ```
- 驗證：訪問 http://<YOUR_BUCKET_NAME>.s3-website.<REGION>.amazonaws.com 看到首頁。 ✓

## 第二階段：CloudFront 整合與安全性加固 (OAC 版)
- 前提條件：CloudFront Distribution 已建立，並在 Origin 設定中建立了 Origin Access Control (OAC)。
- Block Public Access：將開關調回 On (Enabled)。
- Static Website Hosting：改為 Disabled (推薦)。
- 更新 Bucket Policy (OAC 版本)：
  - 快速取得方式：進入 CloudFront 控制台 -> Origins -> 選擇該 S3 Origin -> Edit -> 點擊 "Copy policy" 按鈕。
  - 手動檢查格式：
  - ```JSON
    {
        "Version": "2012-10-17",
        "Statement": {
            "Sid": "AllowCloudFrontServicePrincipalReadOnly",
            "Effect": "Allow",
            "Principal": {
                "Service": "cloudfront.amazonaws.com"
            },
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::<YOUR_BUCKET_NAME>/*",
            "Condition": {
                "StringEquals": {
                    "AWS:SourceArn": "arn:aws:cloudfront::<YOUR_AWS_ACCOUNT_ID>:distribution/<YOUR_CLOUDFRONT_ID>"
                }
            }
        }
    }
    ```

### [提示] 如何取得「你的帳號 ID」？
1. 在 AWS Console 右上角點擊你的使用者名稱/帳號名稱。  
2. 下拉選單中那一串 12 位數字 (例如: 1234-5678-9012) 就是 Account ID。
3. 複製時請移除橫線 -。

## 第三階段：最終驗證
- S3 直連測試：嘗試訪問第一階段的 S3 URL，應該會出現 403 Forbidden 或 Access Denied。 ✓
- CloudFront 測試：訪問 https://xxxx.cloudfront.net，應該能正常看到網站。 ✓
  



# 舊的

- bucket name: 最好取容易辨識 like www.xxx.com
- ACL enabled (if not, static website upload from github action)
  - Object Ownership 開啟 object writer
  - Object Ownership: Bucket owner perferred 也可
- Bucket Versioning: disabled (not sure)
- Server-side encryption settings: SSE-S3
- Bucket Key: disabled
- Object Lock: disabled
- Block all public access: off
- Bucket policy:
```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicRead",
            "Effect": "Allow",
            "Principal": "*",
            "Action": [
                "s3:GetObject",
                "s3:GetObjectVersion"
            ],
            "Resource": "arn:aws:s3:::lixiang-tmp/*"
        }
    ]
}
```
- Static website hosting: enabled
- index documents: index.html
- error documents: index.html
