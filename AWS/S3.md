# 新的 2026
## 第一階段：S3 初期設定（建立 + 測試）
- S3 Bucket 建立
  - 名稱: <YOUR_BUCKET_NAME>
  - 區域: <YOUR_AWS_REGION> (e.g., ap-northeast-1) 
- Block Public Access 設定
  - 暫時全部 Disabled（為了測試 public read）
- Object Ownership ACLs
  - 設定為: Disabled
- Static Website Hosting: 啟用
  - Index document: index.html
- 上傳初始檔案到 bucket
  - 上傳 index.html
- 設定 Bucket Policy
  - 貼入下方 Policy (嚴格json格式不能註解)
  - ```
    {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "AllowPublicReadForTesting",
          "Effect": "Allow",
          "Principal": "*",
          "Action": "s3:GetObject",
          "Resource": "arn:aws:s3:::<YOUR_BUCKET_NAME>/*"
        }
      ]
    }
    ```
- 測試 Bucket Website Endpoint
  - URL: http://<YOUR_BUCKET_NAME>.s3.<YOUR_AWS_REGION>.amazonaws.com/index.html
  - 確認能正常訪問 ✓
    
## 第二階段：CloudFront 完成後的安全設置
- 等待 CloudFront Distribution 完成設定
  - CloudFront OAI ID: <YOUR_CLOUDFRONT_OAI_ID> 
- Block Public Access 改成全部 Enabled
- 更新 Bucket Policy（使用下方版本）
  - 移除測試 Statement
  - 貼入新的 Policy (嚴格json格式不能註解)
  - ```
    {
      "Version": "2012-10-17",
      "Statement": [
        {
            "Sid": "AllowCloudFrontOAIRead",
            "Effect": "Allow",
            "Principal": {
                "AWS": "arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity <YOUR_CLOUDFRONT_OAI_ID>"
             },
             "Action": "s3:GetObject",
             "Resource": "arn:aws:s3:::<YOUR_BUCKET_NAME>/*"
        }
      ]
    }
    ```
- 測試 CloudFront 能正常訪問
  - 確認 Bucket Website Endpoint 已無法訪問（預期行為）
  



# 舊的

- bucket name: 最好取容易辨識 like www.xxx.com
- ACL enabled (if not, static website upload from github action)
  - Object Ownership 開啟 object writer
  - Object Ownership: Bucket owner perferred 也可
- Bucket Versioning: disabled (not sure)
- Server-side encryption settings: SSE-S3
- Bucket Key: disabled
- Object Lock: disabled
- Block all public access: off
- Bucket policy:
```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicRead",
            "Effect": "Allow",
            "Principal": "*",
            "Action": [
                "s3:GetObject",
                "s3:GetObjectVersion"
            ],
            "Resource": "arn:aws:s3:::lixiang-tmp/*"
        }
    ]
}
```
- Static website hosting: enabled
- index documents: index.html
- error documents: index.html
